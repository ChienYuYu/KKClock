"use strict";(self["webpackChunkkkclock"]=self["webpackChunkkkclock"]||[]).push([[738],{4738:function(e,t,l){l.r(t),l.d(t,{default:function(){return we}});var a=l(3396),o=l(7139),r=l(9242);const s={class:"container"},d=(0,a._)("div",{class:"my-4 d-flex justify-content-between"},[(0,a._)("h2",null,"訂單管理")],-1),n={class:"table"},i=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"購買時間"),(0,a._)("th",{scope:"col"},"姓名 / Email"),(0,a._)("th",{scope:"col"},"購買項目"),(0,a._)("th",{scope:"col"},"應付金額"),(0,a._)("th",{scope:"col"},"付款"),(0,a._)("th",{scope:"col"},"檢視/刪除")])],-1),c={class:"list-unstyled"},u={class:"form-check form-switch"},_={class:"form-check-label",for:"flexSwitchCheckDefault"},p=["onUpdate:modelValue","onChange"],h={key:0},m={key:1},g={class:"btn-group",role:"group","aria-label":"Basic example"},w=["onClick"],b=["onClick"];function y(e,t,l,y,f,k){const x=(0,a.up)("LoadingPlugin"),v=(0,a.up)("OrderModal"),D=(0,a.up)("DeleteOrderModal"),O=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(x,{active:f.isLoading},null,8,["active"]),(0,a._)("div",s,[d,(0,a._)("table",n,[i,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.orders,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,o.zw)(new Date(1e3*e.create_at).toLocaleDateString()),1),(0,a._)("td",null,(0,o.zw)(e.user.name)+" / "+(0,o.zw)(e.user.email),1),(0,a._)("td",null,[(0,a._)("ul",c,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,(e=>((0,a.wg)(),(0,a.iD)("li",{key:e.id},(0,o.zw)(e.product.title),1)))),128))])]),(0,a._)("td",null,(0,o.zw)(k.currency(Math.round(e.total))),1),(0,a._)("td",null,[(0,a._)("div",u,[(0,a._)("label",_,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault","onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>k.updatePaid(e)},null,40,p),[[r.e8,e.is_paid]]),e.is_paid?((0,a.wg)(),(0,a.iD)("span",h,"已付款")):((0,a.wg)(),(0,a.iD)("span",m,"未付款"))])])]),(0,a._)("td",null,[(0,a._)("div",g,[(0,a._)("button",{type:"button",class:"btn btn-primary text-white",onClick:t=>k.openOrderModal(e)}," 檢視 ",8,w),(0,a._)("button",{type:"button",class:"btn btn-danger text-white",onClick:t=>k.openDelModal(e)}," 刪除 ",8,b)])])])))),128))])])]),(0,a.Wm)(v,{ref:"orderModal",order:f.tempOrder},null,8,["order"]),(0,a.Wm)(D,{ref:"delOrderModal",onDeleteOrder:k.deleteOrder,order:f.tempOrder},null,8,["onDeleteOrder","order"]),(0,a.Wm)(O,{pages:f.pagination,onPrePage:k.getOrders,onPageNum:k.getOrders,onNextPage:k.getOrders},null,8,["pages","onPrePage","onPageNum","onNextPage"])],64)}const f={class:"modal",tabindex:"-1",ref:"modal"},k={class:"modal-dialog modal-lg"},x={class:"modal-content"},v=(0,a._)("div",{class:"modal-header"},[(0,a._)("h5",{class:"modal-title"},"訂單資料"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},O={class:"row"},z={class:"col-6"},M={class:"table"},C=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col",class:"text-info"},"用戶資料")])],-1),P=(0,a._)("th",{scope:"row"},"姓名",-1),L=(0,a._)("th",{scope:"row"},"Email",-1),$=(0,a._)("th",{scope:"row"},"電話",-1),Z=(0,a._)("th",{scope:"row"},"地址",-1),N={class:"table"},S=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col",class:"text-info"},"訂單細節")])],-1),H=(0,a._)("th",{scope:"row"},"訂單編號",-1),W=(0,a._)("th",{scope:"row"},"下單時間",-1),Y=(0,a._)("th",{scope:"row"},"付款狀態",-1),j={key:0,class:"text-success"},E={key:1,class:"text-danger"},K=(0,a._)("th",{scope:"row"},"付款時間",-1),U={key:0},V={key:1},q={class:"col-6"},B={class:"table"},T=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col",class:"text-info"},"選購商品")])],-1),A={scope:"row"},F={colspan:"3",class:"text-end pe-4"},G={class:"mb-0 text-myred"},I=(0,a._)("span",{class:"text-muted remind"},"(小數點四捨五入)",-1);function J(e,t,l,r,s,d){return(0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("div",k,[(0,a._)("div",x,[v,(0,a._)("div",D,[(0,a._)("div",O,[(0,a._)("div",z,[(0,a._)("table",M,[C,(0,a._)("tbody",null,[(0,a._)("tr",null,[P,(0,a._)("td",null,(0,o.zw)(l.order.user.name),1)]),(0,a._)("tr",null,[L,(0,a._)("td",null,(0,o.zw)(l.order.user.email),1)]),(0,a._)("tr",null,[$,(0,a._)("td",null,(0,o.zw)(l.order.user.tel),1)]),(0,a._)("tr",null,[Z,(0,a._)("td",null,(0,o.zw)(l.order.user.address),1)])])]),(0,a._)("table",N,[S,(0,a._)("tbody",null,[(0,a._)("tr",null,[H,(0,a._)("td",null,(0,o.zw)(l.order.id),1)]),(0,a._)("tr",null,[W,(0,a._)("td",null,(0,o.zw)(new Date(1e3*l.order.create_at).toLocaleDateString()),1)]),(0,a._)("tr",null,[Y,(0,a._)("td",null,[l.order.is_paid?((0,a.wg)(),(0,a.iD)("span",j,"已付款")):((0,a.wg)(),(0,a.iD)("span",E,"尚未付款"))])]),(0,a._)("tr",null,[K,(0,a._)("td",null,[l.order.paid_date?((0,a.wg)(),(0,a.iD)("span",U,(0,o.zw)(new Date(1e3*l.order.paid_date).toLocaleDateString()),1)):((0,a.wg)(),(0,a.iD)("span",V,"尚未付款"))])])])])]),(0,a._)("div",q,[(0,a._)("table",B,[T,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.order.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("th",A,(0,o.zw)(e.product.title),1),(0,a._)("td",null,"數量:"+(0,o.zw)(e.qty),1),(0,a._)("td",null,"價格:NT$"+(0,o.zw)(d.currency(e.final_total)),1)])))),128)),(0,a._)("tr",null,[(0,a._)("td",F,[(0,a._)("p",G,"總計 $"+(0,o.zw)(d.currency(Math.round(l.order.total))),1),I])])])])])])])])])],512)}var Q=l(1339),R={inject:["currency"],props:["order"],data(){return{modal:{}}},mixins:[Q.Z]},X=l(89);const ee=(0,X.Z)(R,[["render",J]]);var te=ee;const le={class:"modal",tabindex:"-1",ref:"modal"},ae={class:"modal-dialog"},oe={class:"modal-content border-0"},re=(0,a._)("div",{class:"modal-header bg-danger text-white"},[(0,a._)("h5",{class:"modal-title"},"刪除訂單"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),se={class:"modal-body"},de=(0,a._)("p",{class:"text-danger"},"※ 刪除後無法復原!",-1),ne={class:"modal-footer"},ie=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function ce(e,t,l,r,s,d){return(0,a.wg)(),(0,a.iD)("div",le,[(0,a._)("div",ae,[(0,a._)("div",oe,[re,(0,a._)("div",se,[(0,a._)("p",null,"姓名: "+(0,o.zw)(l.order.user.name),1),(0,a._)("p",null,"Email: "+(0,o.zw)(l.order.user.email),1),de]),(0,a._)("div",ne,[ie,(0,a._)("button",{type:"button",class:"btn btn-danger text-white",onClick:t[0]||(t[0]=t=>e.$emit("delete-order",l.order))},"確認")])])])],512)}var ue={props:["order"],mixins:[Q.Z]};const _e=(0,X.Z)(ue,[["render",ce]]);var pe=_e,he=l(6109),me={components:{OrderModal:te,DeleteOrderModal:pe,Pagination:he.Z},inject:["currency","emitter"],data(){return{orders:[],pagination:{},tempOrder:{user:{}},isLoading:!1}},methods:{getOrders(e=1){const t=`https://vue3-course-api.hexschool.io/api/chienyu-api/admin/orders?page=${e}`;this.isLoading=!0,this.axios.get(t).then((e=>{this.isLoading=!1,this.orders=e.data.orders,this.pagination=e.data.pagination}))},updatePaid(e){const t=`https://vue3-course-api.hexschool.io/api/chienyu-api/admin/order/${e.id}`;this.isLoading=!0,this.axios.put(t,{data:e}).then((()=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"mygreen",title:"付款狀態已更改"})}))},openOrderModal(e){this.$refs.orderModal.showModal(),this.tempOrder={...e}},openDelModal(e){this.$refs.delOrderModal.showModal(),this.tempOrder={...e}},deleteOrder(e){const t=`https://vue3-course-api.hexschool.io/api/chienyu-api/admin/order/${e.id}`;this.axios.delete(t).then((()=>{this.$refs.delOrderModal.hideModal(),this.getOrders(),this.emitter.emit("push-message",{style:"mygreen",title:"刪除成功"})}))}},created(){this.getOrders()}};const ge=(0,X.Z)(me,[["render",y]]);var we=ge}}]);
//# sourceMappingURL=738.3a7becc8.js.map