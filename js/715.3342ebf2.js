"use strict";(self["webpackChunkkkclock"]=self["webpackChunkkkclock"]||[]).push([[715],{1715:function(t,e,o){o.r(e),o.d(e,{default:function(){return Vt}});var l=o(3396),a=o(7139);const s={class:"container"},c={class:"my-4 d-flex justify-content-between"},i=(0,l._)("h2",null,"產品管理",-1),d=(0,l._)("i",{class:"bi bi-bag-plus-fill me-2"},null,-1),r=(0,l.Uk)("新增產品  "),n=[d,r],u={class:"table"},p=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{scope:"col"},"類別"),(0,l._)("th",{scope:"col"},"名稱"),(0,l._)("th",{scope:"col"},"原價"),(0,l._)("th",{scope:"col"},"售價"),(0,l._)("th",{scope:"col"},"是否啟用"),(0,l._)("th",{scope:"col"},"編輯/刪除")])],-1),m={key:0,class:"text-success"},h={key:1,class:"text-muted"},b={class:"btn-group",role:"group","aria-label":"Basic example"},_=["onClick"],g=["onClick"],P={class:"container"};function f(t,e,o,d,r,f){const w=(0,l.up)("LoadingPlugin"),y=(0,l.up)("ProductModal"),v=(0,l.up)("DeleteProductModal"),x=(0,l.up)("Pagination");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(w,{active:r.isLoading,"onUpdate:active":e[0]||(e[0]=t=>r.isLoading=t)},null,8,["active"]),(0,l._)("div",s,[(0,l._)("div",c,[i,(0,l._)("button",{type:"button",class:"btn btn-dark text-warning",onClick:e[1]||(e[1]=t=>f.openProductModal(!0))},n)]),(0,l._)("table",u,[p,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.products,(t=>((0,l.wg)(),(0,l.iD)("tr",{key:t.id},[(0,l._)("td",null,(0,a.zw)(t.category),1),(0,l._)("td",null,(0,a.zw)(t.title),1),(0,l._)("td",null,(0,a.zw)(f.currency(t.origin_price)),1),(0,l._)("td",null,(0,a.zw)(f.currency(t.price)),1),(0,l._)("td",null,[t.is_enabled?((0,l.wg)(),(0,l.iD)("span",m,"啟用")):((0,l.wg)(),(0,l.iD)("span",h,"未啟用"))]),(0,l._)("td",null,[(0,l._)("div",b,[(0,l._)("button",{type:"button",class:"btn btn-primary text-white",onClick:e=>f.openProductModal(!1,t)}," 編輯 ",8,_),(0,l._)("button",{type:"button",class:"btn btn-danger text-white",onClick:e=>f.openDeleteModal(t)}," 刪除 ",8,g)])])])))),128))])])]),(0,l.Wm)(y,{ref:"productModal",product:r.tempProduct,onUpdateProduct:f.updateProduct},null,8,["product","onUpdateProduct"]),(0,l.Wm)(v,{ref:"deleteProductModal",product:r.tempProduct,onDeleteItem:f.deleteProduct},null,8,["product","onDeleteItem"]),(0,l._)("div",P,[(0,l.Wm)(x,{pages:r.pagination,onPageNum:f.getProducts,onPrePage:f.getProducts,onNextPage:f.getProducts},null,8,["pages","onPageNum","onPrePage","onNextPage"])])],64)}var w=o(9242);const y={class:"modal",tabindex:"-1",ref:"modal"},v={class:"modal-dialog modal-xl"},x={class:"modal-content"},k=(0,l._)("div",{class:"modal-header bg-light"},[(0,l._)("h5",{class:"modal-title"},"產品管理"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),U={class:"modal-body"},C={class:"row"},M={class:"col-8"},D={class:"row"},$={class:"col-12 mb-3"},L={for:"productName",class:"form-label w-100"},N=(0,l._)("p",{class:"mb-2"},"產品名稱",-1),V={class:"col-6 mb-3"},I={for:"productCategory",class:"form-label w-100"},z=(0,l._)("p",{class:"mb-2"},"分類",-1),Z={class:"col-6 mb-3"},B={for:"productUnit",class:"form-label w-100"},W=(0,l._)("p",{class:"mb-2"},"單位",-1),F={class:"col-6 mb-3"},j={for:"originalPrice",class:"form-label w-100"},H=(0,l._)("p",{class:"mb-2"},"原價",-1),Y={class:"col-6 mb-3"},K={for:"productPrice",class:"form-label w-100"},q=(0,l._)("p",{class:"mb-2"},"售價",-1),A={class:"col-12 mb-3"},E={for:"productDescription",class:"form-label w-100"},G=(0,l._)("p",{class:"mb-2"},"產品描述",-1),J={class:"col-12 mb-3"},O={for:"productContent",class:"form-label w-100"},Q=(0,l._)("p",{class:"mb-2"},"產品內容",-1),R={class:"col-4"},S={class:"row"},T={class:"col-12 mb-3"},X={for:"productUrl",class:"form-label w-100"},tt=(0,l._)("p",{class:"mb-2"},"輸入圖片網址",-1),et={class:"col-12 mb-3"},ot={for:"uploadImg",class:"form-label w-100"},lt=(0,l._)("p",{class:"mb-2"},"上傳圖片",-1),at=["src"],st={class:"col-12"},ct={class:"form-check"},it={class:"form-check-label",for:"enableProduct"},dt=(0,l.Uk)(" 啟用 "),rt={class:"modal-footer"},nt=(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function ut(t,e,o,a,s,c){const i=(0,l.up)("LoadingPlugin");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(i,{active:s.isLoading,"onUpdate:active":e[0]||(e[0]=t=>s.isLoading=t)},null,8,["active"]),(0,l._)("div",y,[(0,l._)("div",v,[(0,l._)("div",x,[k,(0,l._)("div",U,[(0,l._)("div",C,[(0,l._)("div",M,[(0,l._)("div",D,[(0,l._)("div",$,[(0,l._)("label",L,[N,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"productName",placeholder:"請輸入產品名稱","onUpdate:modelValue":e[1]||(e[1]=t=>s.tempProduct.title=t)},null,512),[[w.nr,s.tempProduct.title]])])]),(0,l._)("div",V,[(0,l._)("label",I,[z,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"productCategory",placeholder:"請輸入分類名稱","onUpdate:modelValue":e[2]||(e[2]=t=>s.tempProduct.category=t)},null,512),[[w.nr,s.tempProduct.category]])])]),(0,l._)("div",Z,[(0,l._)("label",B,[W,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"productUnit",placeholder:"請輸入單位名稱","onUpdate:modelValue":e[3]||(e[3]=t=>s.tempProduct.unit=t)},null,512),[[w.nr,s.tempProduct.unit]])])]),(0,l._)("div",F,[(0,l._)("label",j,[H,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"originalPrice",placeholder:"請輸入原價","onUpdate:modelValue":e[4]||(e[4]=t=>s.tempProduct.origin_price=t)},null,512),[[w.nr,s.tempProduct.origin_price]])])]),(0,l._)("div",Y,[(0,l._)("label",K,[q,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",id:"productPrice",placeholder:"請輸入售價","onUpdate:modelValue":e[5]||(e[5]=t=>s.tempProduct.price=t)},null,512),[[w.nr,s.tempProduct.price]])])]),(0,l._)("div",A,[(0,l._)("label",E,[G,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"productDescription",placeholder:"請輸入產品描述","onUpdate:modelValue":e[6]||(e[6]=t=>s.tempProduct.description=t)},null,512),[[w.nr,s.tempProduct.description]])])]),(0,l._)("div",J,[(0,l._)("label",O,[Q,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"productContent",placeholder:"請輸入產品內容","onUpdate:modelValue":e[7]||(e[7]=t=>s.tempProduct.content=t)},null,512),[[w.nr,s.tempProduct.content]])])])])]),(0,l._)("div",R,[(0,l._)("div",S,[(0,l._)("div",T,[(0,l._)("label",X,[tt,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",id:"productUrl",placeholder:"輸入圖片網址","onUpdate:modelValue":e[8]||(e[8]=t=>s.tempProduct.imageUrl=t)},null,512),[[w.nr,s.tempProduct.imageUrl]])])]),(0,l._)("div",et,[(0,l._)("label",ot,[lt,(0,l._)("input",{type:"file",class:"form-control",id:"uploadImg",ref:"fileInput",onChange:e[9]||(e[9]=(...t)=>c.uploadFile&&c.uploadFile(...t))},null,544)])]),(0,l._)("div",null,[(0,l._)("img",{src:s.tempProduct.imageUrl,alt:"產品圖片",class:"img-fluid"},null,8,at)]),(0,l._)("div",st,[(0,l._)("div",ct,[(0,l._)("label",it,[dt,(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:"enableProduct","onUpdate:modelValue":e[10]||(e[10]=t=>s.tempProduct.is_enabled=t)},null,512),[[w.e8,s.tempProduct.is_enabled]])])])])])])])]),(0,l._)("div",rt,[nt,(0,l._)("button",{type:"button",class:"btn btn-primary text-white",onClick:e[11]||(e[11]=e=>t.$emit("update-product",s.tempProduct))}," 確認 ")])])])],512)],64)}var pt=o(1339),mt={props:["product"],emits:["update-product"],data(){return{modal:{},tempProduct:{},isLoading:!1}},watch:{product(){this.tempProduct=this.product}},methods:{uploadFile(){const t=this.$refs.fileInput.files[0],e=new FormData;e.append("file-to-upload",t);const o="https://vue3-course-api.hexschool.io/api/chienyu-api/admin/upload";this.isLoading=!0,this.axios.post(o,e).then((t=>{this.isLoading=!1,t.data.success&&(this.tempProduct.imageUrl=t.data.imageUrl,this.$refs.fileInput.value="")})).catch((()=>{this.isLoading=!1,this.$swal({title:"似乎有些問題 請稍後再嘗試",icon:"error",showConfirmButton:!1,timer:2e3})}))}},mixins:[pt.Z]},ht=o(89);const bt=(0,ht.Z)(mt,[["render",ut]]);var _t=bt;const gt={class:"modal",tabindex:"-1",ref:"modal"},Pt={class:"modal-dialog"},ft={class:"modal-content border-0"},wt=(0,l._)("div",{class:"modal-header bg-danger"},[(0,l._)("h5",{class:"modal-title text-white"},"刪除"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),yt={class:"modal-body"},vt=(0,l._)("p",{class:"text-danger"},"※ 刪除後將無法復原!",-1),xt={class:"modal-footer"},kt=(0,l._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function Ut(t,e,o,s,c,i){return(0,l.wg)(),(0,l.iD)("div",gt,[(0,l._)("div",Pt,[(0,l._)("div",ft,[wt,(0,l._)("div",yt,[(0,l._)("p",null,"類別:【"+(0,a.zw)(o.product.category)+"】 名稱:【"+(0,a.zw)(o.product.title)+"】",1),vt]),(0,l._)("div",xt,[kt,(0,l._)("button",{type:"button",class:"btn btn-danger text-white",onClick:e[0]||(e[0]=e=>t.$emit("delete-item",o.product))}," 確認 ")])])])],512)}var Ct={props:["product"],mixins:[pt.Z]};const Mt=(0,ht.Z)(Ct,[["render",Ut]]);var Dt=Mt,$t=o(2151),Lt={inject:["currency","emitter"],data(){return{products:[],pagination:{},tempProduct:{},isNew:!1,isLoading:!1}},methods:{getProducts(t=1){const e=`https://vue3-course-api.hexschool.io/api/chienyu-api/admin/products?page=${t}`;this.isLoading=!0,this.axios.get(e).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.$swal({title:"似乎有些問題 請稍後再嘗試",icon:"error",showConfirmButton:!1,timer:2e3}),this.isLoading=!1}))},openProductModal(t,e){this.tempProduct=t?{}:{...e},this.$refs.productModal.showModal(),this.isNew=t},updateProduct(t){let e="https://vue3-course-api.hexschool.io/api/chienyu-api/admin/product",o="post";!1===this.isNew&&(e=`https://vue3-course-api.hexschool.io/api/chienyu-api/admin/product/${t.id}`,o="put"),this.axios[o](e,{data:t}).then((t=>{this.$refs.productModal.hideModal(),t.data.success?(this.getProducts(),this.emitter.emit("push-message",{style:"mygreen",title:this.isNew?"新增成功":"更新成功"})):this.emitter.emit("push-message",{style:"myred",title:this.isNew?"新增失敗":"更新失敗",content:t.data.message.join("、")})})).catch((()=>{this.$swal({title:"似乎有些問題 請稍後再嘗試",icon:"error",showConfirmButton:!1,timer:2e3})}))},openDeleteModal(t){this.$refs.deleteProductModal.showModal(),this.tempProduct=t},deleteProduct(t){const e=`https://vue3-course-api.hexschool.io/api/chienyu-api/admin/product/${t.id}`;this.axios.delete(e).then((()=>{this.$refs.deleteProductModal.hideModal(),this.getProducts(),this.emitter.emit("push-message",{style:"mygreen",title:"刪除成功"})})).catch((()=>{this.$swal({title:"似乎有些問題 請稍後再嘗試",icon:"error",showConfirmButton:!1,timer:2e3})}))}},components:{ProductModal:_t,DeleteProductModal:Dt,Pagination:$t.Z},created(){this.getProducts()}};const Nt=(0,ht.Z)(Lt,[["render",f]]);var Vt=Nt}}]);
//# sourceMappingURL=715.3342ebf2.js.map