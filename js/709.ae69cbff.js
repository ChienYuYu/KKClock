"use strict";(self["webpackChunkkkclock"]=self["webpackChunkkkclock"]||[]).push([[709],{8379:function(t,e,n){function o(t){const e=parseInt(t,10);return`${e.toFixed(0).replace(/./g,((t,e,n)=>e&&"."!==t&&(n.length-e)%3===0?`, ${t}`.replace(/\s/g,""):t))}`}n.d(e,{Z:function(){return o}})},8557:function(t,e,n){function o(t){return{all:t=t||new Map,on:function(e,n){var o=t.get(e);o?o.push(n):t.set(e,[n])},off:function(e,n){var o=t.get(e);o&&(n?o.splice(o.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var o=t.get(e);o&&o.slice().map((function(t){t(n)})),(o=t.get("*"))&&o.slice().map((function(t){t(e,n)}))}}}n.d(e,{Z:function(){return c}});const a=o();var c=a},1720:function(t,e,n){n.d(e,{Z:function(){return x}});var o=n(3396),a=n(7139);const c={class:"mt-5 pt-5 container d-flex justify-content-center"},s={class:"step-list list-unstyled rounded-3 overflow-hidden"},l=(0,o.Uk)("STEP1"),u=(0,o._)("br",null,null,-1),i=(0,o.Uk)("確認訂單"),r=[l,u,i],d=(0,o.Uk)("STEP2"),p=(0,o._)("br",null,null,-1),h=(0,o.Uk)("填寫資料"),b=[d,p,h],_=(0,o.Uk)("STEP3"),f=(0,o._)("br",null,null,-1),v=(0,o.Uk)("確認付款"),y=[_,f,v];function m(t,e,n,l,u,i){return(0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("ul",s,[(0,o._)("li",{class:(0,a.C_)({"step-active":1===u.stepStatus})},r,2),(0,o._)("li",{class:(0,a.C_)({"step-active":2===u.stepStatus})},b,2),(0,o._)("li",{class:(0,a.C_)({"step-active":3===u.stepStatus})},y,2)])])}var C={data(){return{stepStatus:0}},created(){"/cart"===this.$route.path&&(this.stepStatus=1),"/buyer_info"===this.$route.path&&(this.stepStatus=2),this.$route.path===`/checkout/${this.$route.params.orderId}`&&(this.stepStatus=3)}},g=n(89);const k=(0,g.Z)(C,[["render",m]]);var x=k},3709:function(t,e,n){n.r(e),n.d(e,{default:function(){return A}});var o=n(3396),a=n(7139),c=n(9242);const s=t=>((0,o.dD)("data-v-3d099852"),t=t(),(0,o.Cn)(),t),l={class:"container mt-5"},u={class:"col-12 col-md-10 mx-auto"},i={class:"table align-middle"},r=s((()=>(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{scope:"col"},"品名"),(0,o._)("th",{scope:"col"},"數量"),(0,o._)("th",{scope:"col"},"合計"),(0,o._)("th",{scope:"col"})])],-1))),d={class:"text-nowrap small-font ps-1 pe-0"},p={class:"d-flex col-12 col-md-6 col-lg-3"},h=["onClick"],b=s((()=>(0,o._)("i",{class:"bi bi-plus"},null,-1))),_=[b],f=["onUpdate:modelValue"],v=["onClick","disabled"],y=s((()=>(0,o._)("i",{class:"bi bi-dash"},null,-1))),m=[y],C={class:"small-font"},g=["onClick"],k=s((()=>(0,o._)("i",{class:"bi bi-trash"},null,-1))),x=[k],w=s((()=>(0,o._)("tr",null,[(0,o._)("td",{class:"border-0"})],-1))),$={colspan:"4"},S={class:"col-md-8 col-lg-4"},P={class:"input-group mb-3"},q=["disabled"],D={key:0,class:"text-myorange text-center"},H={key:1,class:"text-myred text-center"},U={colspan:"4"},Z={class:"text-mygreen text-end px-5"},B={class:"text-myorange text-end px-5"},z={class:"text-myred text-end px-5"},E={class:"d-flex justify-content-center p-5"};function I(t,e,n,s,b,y){const k=(0,o.up)("LoadingPlugin"),I=(0,o.up)("ProgressBar");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(k,{active:s.isLoading},null,8,["active"]),(0,o.Wm)(I),(0,o._)("div",l,[(0,o._)("div",u,[(0,o._)("table",i,[r,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.carts,(t=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("td",d,(0,a.zw)(t.product.title),1),(0,o._)("td",null,[(0,o._)("div",p,[(0,o._)("button",{class:"btn btn-sm btn-secondary rounded-0",type:"button",onClick:e=>s.updateCart(t.id,t.qty+1)},_,8,h),(0,o.wy)((0,o._)("input",{type:"number",class:"form-control rounded-0 px-1 text-center bg-white",min:"1",id:"qty","onUpdate:modelValue":e=>t.qty=e,"aria-label":"qty",disabled:""},null,8,f),[[c.nr,t.qty]]),(0,o._)("button",{class:"btn btn-sm btn-secondary rounded-0",type:"button",onClick:e=>s.updateCart(t.id,t.qty-1),disabled:1===t.qty},m,8,v)])]),(0,o._)("td",C,"$"+(0,a.zw)(s.currency(t.total)),1),(0,o._)("td",null,[(0,o._)("button",{type:"button",class:"btn btn-danger btn",onClick:e=>s.deleteCart(t.id)},x,8,g)])])))),128)),w,(0,o._)("tr",null,[(0,o._)("td",$,[(0,o._)("div",S,[(0,o._)("div",P,[(0,o._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[0]||(e[0]=(...t)=>s.useCouponCode&&s.useCouponCode(...t)),disabled:s.discount>0}," 套用優惠碼 ",8,q),(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","aria-label":"coupon","aria-describedby":"button-coupon","onUpdate:modelValue":e[1]||(e[1]=t=>s.couponCode=t)},null,512),[[c.nr,s.couponCode]])]),!0===s.couponStatus?((0,o.wg)(),(0,o.iD)("p",D," 優惠碼套用成功! ")):!1===s.couponStatus?((0,o.wg)(),(0,o.iD)("p",H," 優惠碼無效 請重新輸入! ")):(0,o.kq)("",!0)])])]),(0,o._)("tr",null,[(0,o._)("td",U,[(0,o._)("p",Z,"合計 $"+(0,a.zw)(s.currency(s.totalPrice)),1),(0,o._)("p",B," 優惠券折扣 $"+(0,a.zw)(s.currency(Math.round(s.discount))),1),(0,o._)("p",z,"總計 $"+(0,a.zw)(s.currency(Math.round(s.finalPrice))),1)])])])]),(0,o._)("div",E,[(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:e[2]||(e[2]=e=>t.$router.push("/buyer_info"))}," 下一步 ")])])])],64)}var L=n(4870),M=n(2483),T=n(8557),V=n(8379),j=n(2492),W=n.n(j),Y=n(1720),F={components:{ProgressBar:Y.Z},setup(){const t=(0,o.f3)("axios"),e=(0,M.tv)(),n=(0,L.iH)([]),a=(0,L.iH)(0),c=(0,L.iH)(0),s=(0,L.iH)(0),l=(0,L.iH)(""),u=(0,L.iH)(""),i=(0,L.iH)(!1),r=()=>{const o="https://vue3-course-api.hexschool.io/api/chienyu-api/cart";i.value=!0,t.get(o).then((t=>{n.value=t.data.data.carts,a.value=t.data.data.total,c.value=t.data.data.final_total,s.value=a.value-c.value,i.value=!1})).catch((()=>{i.value=!1,W().fire({title:"似乎有些問題 請稍後再來訪",icon:"error",showConfirmButton:!1,timer:2e3}),e.push("/")}))};r(),(0,o.bv)((()=>{T.Z.on("updateData",(()=>{r()}))}));const d=(e,n)=>{const o={data:{product_id:e,qty:n}},a=`https://vue3-course-api.hexschool.io/api/chienyu-api/cart/${e}`;t.put(a,o).then((()=>{r()})).catch((()=>{i.value=!1,W().fire({title:"似乎有些問題 請稍後再嘗試",icon:"error",showConfirmButton:!1,timer:2e3})}))},p=e=>{const n=`https://vue3-course-api.hexschool.io/api/chienyu-api/cart/${e}`;t.delete(n).then((()=>{r(),T.Z.emit("updateData")})).catch((()=>{W().fire({title:"似乎有些問題 請稍後再嘗試",icon:"error",showConfirmButton:!1,timer:2e3})}))},h=()=>{const e="https://vue3-course-api.hexschool.io/api/chienyu-api/coupon";t.post(e,{data:{code:l.value}}).then((t=>{r(),t.data.success?u.value=!0:u.value=!1})).catch((()=>{W().fire({title:"似乎有些問題 請稍後再嘗試",icon:"error",showConfirmButton:!1,timer:2e3})}))};return{currency:V.Z,carts:n,totalPrice:a,finalPrice:c,discount:s,couponCode:l,couponStatus:u,isLoading:i,getCarts:r,updateCart:d,deleteCart:p,useCouponCode:h}}},K=n(89);const O=(0,K.Z)(F,[["render",I],["__scopeId","data-v-3d099852"]]);var A=O}}]);
//# sourceMappingURL=709.ae69cbff.js.map